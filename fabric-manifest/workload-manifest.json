{
  "$schema": "https://developer.microsoft.com/json-schemas/fabric/workload/v1.0/workloadManifest.json",
  "workloadManifest": {
    "manifestVersion": "1.0",
    "workloadDetails": {
      "workloadId": "fabric-mapping-service",
      "displayName": "Reference Table & Data Mapping Service",
      "description": "A comprehensive reference table (KeyMapping) and data mapping service for Microsoft Fabric that enables data classification, harmonization, and transformation. Provides reference tables as KeyMapping outports for consumption by other data products.",
      "version": "1.0.0",
      "publisher": "philippfrenzel",
      "category": "DataIntegration",
      "tags": [
        "reference-tables",
        "keymapping",
        "lookup-tables",
        "data-classification",
        "master-data",
        "mapping",
        "data-transformation",
        "etl",
        "integration"
      ]
    },
    "authentication": {
      "authenticationMethod": "AAD",
      "aadAppId": "YOUR_AAD_APP_ID_HERE",
      "requiredScopes": [
        "https://analysis.windows.net/powerbi/api/.default"
      ]
    },
    "backend": {
      "backendUrl": "YOUR_BACKEND_URL_HERE",
      "endpoints": [
        {
          "name": "WorkloadInfo",
          "path": "/api/workload/info",
          "method": "GET",
          "description": "Get workload metadata and information"
        },
        {
          "name": "WorkloadHealth",
          "path": "/api/workload/health",
          "method": "GET",
          "description": "Get workload health status"
        },
        {
          "name": "ExecuteWorkload",
          "path": "/api/workload/execute",
          "method": "POST",
          "description": "Execute a workload operation (reference tables, mapping, etc.)"
        },
        {
          "name": "ValidateWorkloadConfiguration",
          "path": "/api/workload/validate",
          "method": "POST",
          "description": "Validate workload configuration before execution"
        },
        {
          "name": "ListReferenceTables",
          "path": "/api/reference-tables",
          "method": "GET",
          "description": "List all reference tables (KeyMapping outports)"
        },
        {
          "name": "GetReferenceTable",
          "path": "/api/reference-tables/{tableName}",
          "method": "GET",
          "description": "Get reference table data by name"
        },
        {
          "name": "CreateReferenceTable",
          "path": "/api/reference-tables",
          "method": "POST",
          "description": "Create a new reference table for data classification"
        },
        {
          "name": "SyncReferenceTable",
          "path": "/api/reference-tables/sync",
          "method": "POST",
          "description": "Sync reference table with source data (adds new keys only)"
        },
        {
          "name": "UpdateReferenceTableRow",
          "path": "/api/reference-tables/{tableName}/rows",
          "method": "PUT",
          "description": "Add or update a row in a reference table"
        },
        {
          "name": "DeleteReferenceTable",
          "path": "/api/reference-tables/{tableName}",
          "method": "DELETE",
          "description": "Delete a reference table"
        },
        {
          "name": "MappingInfo",
          "path": "/api/mapping/info",
          "method": "GET",
          "description": "Get information about available mapping operations"
        },
        {
          "name": "HealthCheck",
          "path": "/api/mapping/health",
          "method": "GET",
          "description": "Health check endpoint for the mapping service"
        },
        {
          "name": "MapLegacyCustomer",
          "path": "/api/mapping/customer/legacy-to-modern",
          "method": "POST",
          "description": "Map legacy customer data to modern format"
        },
        {
          "name": "MapExternalProduct",
          "path": "/api/mapping/product/external-to-internal",
          "method": "POST",
          "description": "Map external product data to internal format"
        },
        {
          "name": "BatchMapCustomers",
          "path": "/api/mapping/customer/batch-legacy-to-modern",
          "method": "POST",
          "description": "Batch map multiple legacy customers"
        }
      ]
    },
    "frontend": {
      "entryPointUrl": "YOUR_FRONTEND_URL_HERE",
      "routes": [
        {
          "path": "/mapping",
          "displayName": "Mapping Service",
          "icon": "DataManagementSettings"
        }
      ]
    },
    "itemTypes": [
      {
        "name": "ReferenceTable",
        "displayName": "Reference Table (KeyMapping)",
        "description": "Reference table for data classification and harmonization - provides KeyMapping outport for consumption by other data products",
        "icon": "Table",
        "capabilities": [
          "Create",
          "Read",
          "Update",
          "Delete",
          "Share",
          "Export"
        ],
        "properties": [
          {
            "name": "tablename",
            "displayName": "Table Name",
            "type": "string",
            "required": true
          },
          {
            "name": "columns",
            "displayName": "Columns",
            "type": "array",
            "required": true
          },
          {
            "name": "isvisible",
            "displayName": "Is Visible",
            "type": "boolean",
            "required": false
          },
          {
            "name": "outporttype",
            "displayName": "Outport Type",
            "type": "string",
            "required": false,
            "defaultValue": "KeyMapping"
          },
          {
            "name": "sourcelakehouseitemid",
            "displayName": "Source Lakehouse Item ID",
            "type": "string",
            "required": false,
            "description": "OneLake item ID of the lakehouse table that provides the reference data"
          },
          {
            "name": "sourceworkspaceid",
            "displayName": "Source Workspace ID",
            "type": "string",
            "required": false,
            "description": "Workspace ID of the lakehouse that contains the reference table"
          },
          {
            "name": "sourcetablename",
            "displayName": "Source Table Name",
            "type": "string",
            "required": false,
            "description": "Name of the table in the lakehouse that provides the reference data"
          },
          {
            "name": "sourceonelakelink",
            "displayName": "Source OneLake Link",
            "type": "string",
            "required": false,
            "description": "OneLake link to the source table"
          }
        ]
      },
      {
        "name": "MappingConfiguration",
        "displayName": "Mapping Configuration",
        "description": "Configuration for data attribute mappings",
        "icon": "Settings",
        "capabilities": [
          "Create",
          "Read",
          "Update",
          "Delete",
          "Share"
        ],
        "properties": [
          {
            "name": "sourcetype",
            "displayName": "Source Type",
            "type": "string",
            "required": true
          },
          {
            "name": "targettype",
            "displayName": "Target Type",
            "type": "string",
            "required": true
          },
          {
            "name": "profilename",
            "displayName": "Profile Name",
            "type": "string",
            "required": false
          }
        ]
      },
      {
        "name": "MappingJob",
        "displayName": "Mapping Job",
        "description": "Execute data mapping operations",
        "icon": "Processing",
        "capabilities": [
          "Create",
          "Read",
          "Delete",
          "Execute"
        ],
        "properties": [
          {
            "name": "configurationid",
            "displayName": "Configuration ID",
            "type": "string",
            "required": true
          },
          {
            "name": "status",
            "displayName": "Status",
            "type": "string",
            "required": true
          }
        ]
      }
    ],
    "permissions": {
      "requiredPermissions": [
        {
          "name": "Workspace.Read.All",
          "description": "Read workspace items"
        },
        {
          "name": "Workspace.ReadWrite.All",
          "description": "Read and write workspace items"
        }
      ]
    },
    "dataAccess": {
      "oneLake": {
        "enabled": true,
        "description": "Store mapping configurations and results in OneLake"
      }
    }
  }
}
